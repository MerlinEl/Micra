 fn changeCPOrderToggle=
(	
	local max_ini = getMaxIniFile()	
	local order = getIniSetting max_ini "WindowState" "WindowOrder" == "8"
	setIniSetting max_ini "WindowState" "WindowOrder" ( if order then "0" else "8")
	format "Is docked on top?:%\n" (not order)
	cui.commandPanelOpen = false
	cui.commandPanelOpen = true	
)
changeCPOrderToggle()
 
fn displayCPButtonsToggle=
(
	local max_ini = getMaxIniFile()
	local visible = getIniSetting max_ini "Modstack"  "visible" == "1"
	setIniSetting max_ini "Modstack"  "visible" (if visible then "0" else "1")
	format "Is visible?:%\n" (not visible)
	cui.commandPanelOpen = false
	cui.commandPanelOpen = true	 
)
displayCPButtonsToggle()

 /*
  	local ini = cui.getConfigFile()
 	local pos = getIniSetting ini "Command Panel" "CurPos"
 */
 
 
 
 --press collapse button i n editable poly modify panel
 if (hwnd = windows.getChildHWND #max "Collapse") != undefined do UIAccessor.PressButton hwnd[1]
 
 
 --
 #(66450P, 65552P, 66406P, "TaskSwitcherWnd", "Task Switching", 66406P, 66450P, 66406P),
 
 
 "Main Toolbar""CustToolbar""CustButton""CustSeparator""ComboBox""All""CustButton"
 Show Buttons
item:#(2166150P, 1903008P, 1903008P, "#32770", "", 0P, 2432120P, 2432120P)
item:#(657904P, 2166150P, 2166150P, "ListBox", "", 0P, 2432120P, 2432120P)
item:#(657658P, 2166150P, 2166150P, "CustButton", "Sets", 0P, 2432120P, 2432120P)
item:#(657614P, 2166150P, 2166150P, "CustButton", "", 0P, 2432120P, 2432120P)
item:#(657600P, 2166150P, 2166150P, "CustButton", "Skin", 0P, 2432120P, 2432120P)
item:#(723294P, 2166150P, 2166150P, "CustButton", "Skin Wrap", 0P, 2432120P, 2432120P)
item:#(657464P, 2166150P, 2166150P, "CustButton", "STL Check", 0P, 2432120P, 2432120P)
item:#(657996P, 2166150P, 2166150P, "CustButton", "Edit Poly", 0P, 2432120P, 2432120P)
item:#(722940P, 2166150P, 2166150P, "CustButton", "Morph UV Data", 0P, 2432120P, 2432120P)
item:#(657576P, 2166150P, 2166150P, "CustButton", "", 0P, 2432120P, 2432120P)

Item:#(1903008P, 592690P, 592690P, "ModifyTask", "", 0P, 2432120P, 2432120P)
Child:#(#(658238P, 1903008P, 1903008P, "RollupWindow", "", 0P, 2432120P, 2432120P), #(657468P, 658238P, 658238P, "GRAY", "", 0P, 2432120P, 2432120P), #(1315084P, 657468P, 657468P, "RollupPanel", "", 0P, 2432120P, 2432120P), #(1185004P, 1315084P, 1315084P, "RollupPanelTitle", "Selection", 0P, 2432120P, 2432120P), #(1380610P, 1315084P, 1315084P, "#32770", "", 0P, 2432120P, 2432120P), #(1056182P, 1380610P, 1380610P, "CustToolbar", "", 0P, 2432120P, 2432120P), #(1249542P, 1056182P, 1056182P, "CustButton", "", 0P, 2432120P, 2432120P), #(1053828P, 1056182P, 1056182P, "CustButton", "", 0P, 2432120P, 2432120P), #(1315090P, 1056182P, 1056182P, "CustButton", "", 0P, 2432120P, 2432120P), #(1773550P, 1056182P, 1056182P, "CustButton", "", 0P, 2432120P, 2432120P), #(1249536P, 1056182P, 1056182P, "CustButton", "", 0P, 2432120P, 2432120P), #(990666P, 1380610P, 1380610P, "CustButton", "Shrink", 0P, 2432120P, 2432120P), #(1055964P, 1380610P, 1380610P, "CustButton", "Grow", 0P, 2432120P, 2432120P), #(1252490P, 1380610P, 1380610P, "Button", "By Vertex", 0P, 2432120P, 2432120P), #(990392P, 1380610P, 1380610P, "Button", "Ignore Backfacing", 0P, 2432120P, 2432120P), #(990386P, 1380610P, 1380610P, "CustButton", "Ring", 0P, 2432120P, 2432120P), #(794238P, 1380610P, 1380610P, "CustButton", "Loop", 0P, 2432120P, 2432120P), #(794284P, 1380610P, 1380610P, "Static", "Vertex 118 Selected", 0P, 2432120P, 2432120P), #(1252126P, 1380610P, 1380610P, "Button", "By Angle:", 0P, 2432120P, 2432120P), #(9771222P, 1380610P, 1380610P, "CustEdit", "", 0P, 2432120P, 2432120P), ...)
Child:#(#(2886616P, 592690P, 592690P, "CreateTask", "", 0P, 2432120P, 2432120P), #(2165016P, 2886616P, 2886616P, "RollupWindow", "", 0P, 2432120P, 2432120P), #(1903680P, 2165016P, 2165016P, "GRAY", "", 0P, 2432120P, 2432120P), #(2100510P, 1903680P, 1903680P, "RollupPanel", "", 0P, 2432120P, 2432120P), #(658324P, 2100510P, 2100510P, "RollupPanelTitle", "Name and Color", 0P, 2432120P, 2432120P), #(2100612P, 2100510P, 2100510P, "#32770", "", 0P, 2432120P, 2432120P), #(2100610P, 2100612P, 2100612P, "CustEdit", "User1", 0P, 2432120P, 2432120P), #(593278P, 2100610P, 2100610P, "EDITDUMMY", "", 0P, 2432120P, 2432120P), #(592756P, 593278P, 593278P, "Edit", "Sphere001", 0P, 2432120P, 2432120P), #(657916P, 2100612P, 2100612P, "Button", "", 0P, 2432120P, 2432120P), #(591744P, 1903680P, 1903680P, "RollupPanel", "", 0P, 2432120P, 2432120P), #(593368P, 591744P, 591744P, "RollupPanelTitle", "Object Type", 0P, 2432120P, 2432120P), #(1121268P, 591744P, 591744P, "#32770", "", 0P, 2432120P, 2432120P), #(990210P, 1121268P, 1121268P, "CustButton", "Box", 0P, 2432120P, 2432120P), #(924612P, 1121268P, 1121268P, "CustButton", "Cone", 0P, 2432120P, 2432120P), #(593488P, 1121268P, 1121268P, "CustButton", "Sphere", 0P, 2432120P, 2432120P), #(789530P, 1121268P, 1121268P, "CustButton", "GeoSphere", 0P, 2432120P, 2432120P), #(724256P, 1121268P, 1121268P, "CustButton", "Cylinder", 0P, 2432120P, 2432120P), #(593186P, 1121268P, 1121268P, "CustButton", "Tube", 0P, 2432120P, 2432120P), #(593188P, 1121268P, 1121268P, "CustButton", "Torus", 0P, 2432120P, 2432120P), ...)
Child:#(#(2886616P, 592690P, 592690P, "CreateTask", "", 0P, 2432120P, 2432120P), #(2165016P, 2886616P, 2886616P, "RollupWindow", "", 0P, 2432120P, 2432120P), #(1903680P, 2165016P, 2165016P, "GRAY", "", 0P, 2432120P, 2432120P), #(2100510P, 1903680P, 1903680P, "RollupPanel", "", 0P, 2432120P, 2432120P), #(658324P, 2100510P, 2100510P, "RollupPanelTitle", "Name and Color", 0P, 2432120P, 2432120P), #(2100612P, 2100510P, 2100510P, "#32770", "", 0P, 2432120P, 2432120P), #(2100610P, 2100612P, 2100612P, "CustEdit", "User1", 0P, 2432120P, 2432120P), #(593278P, 2100610P, 2100610P, "EDITDUMMY", "", 0P, 2432120P, 2432120P), #(592756P, 593278P, 593278P, "Edit", "Sphere001", 0P, 2432120P, 2432120P), #(657916P, 2100612P, 2100612P, "Button", "", 0P, 2432120P, 2432120P), #(591744P, 1903680P, 1903680P, "RollupPanel", "", 0P, 2432120P, 2432120P), #(593368P, 591744P, 591744P, "RollupPanelTitle", "Object Type", 0P, 2432120P, 2432120P), #(1121268P, 591744P, 591744P, "#32770", "", 0P, 2432120P, 2432120P), #(990210P, 1121268P, 1121268P, "CustButton", "Box", 0P, 2432120P, 2432120P), #(924612P, 1121268P, 1121268P, "CustButton", "Cone", 0P, 2432120P, 2432120P), #(593488P, 1121268P, 1121268P, "CustButton", "Sphere", 0P, 2432120P, 2432120P), #(789530P, 1121268P, 1121268P, "CustButton", "GeoSphere", 0P, 2432120P, 2432120P), #(724256P, 1121268P, 1121268P, "CustButton", "Cylinder", 0P, 2432120P, 2432120P), #(593186P, 1121268P, 1121268P, "CustButton", "Tube", 0P, 2432120P, 2432120P), #(593188P, 1121268P, 1121268P, "CustButton", "Torus", 0P, 2432120P, 2432120P), ...)
Name:ModifyTask

Name:Modifier List
Child:#(#(1312954P, 65552P, 65552P, "ComboLBox", "", 0P, 1312954P, 65552P), #(925364P, 65552P, 3152952P, "WindowsForms10.Window.20808.app.0.b71fd5_r41_ad1", "", 3152952P, 925364P, 3152952P), #(266178P, 65552P, 0P, "OpWindowDS", "", 0P, 266178P, 266178P), #(66450P, 65552P, 66406P, "TaskSwitcherWnd", "Task Switching", 66406P, 66450P, 66406P), #(65978P, 65552P, 65940P, "tooltips_class32", "", 65940P, 65978P, 65940P), #(65958P, 65552P, 65940P, "tooltips_class32", "", 65940P, 65958P, 65940P), #(65986P, 65552P, 65940P, "tooltips_class32", "", 65940P, 65986P, 65940P), #(65982P, 65552P, 65940P, "tooltips_class32", "", 65940P, 65982P, 65940P), #(66002P, 65552P, 65940P, "tooltips_class32", "", 65940P, 66002P, 65940P), #(65988P, 65552P, 65940P, "tooltips_class32", "", 65940P, 65988P, 65940P), #(65980P, 65552P, 65940P, "tooltips_class32", "", 65940P, 65980P, 65940P), #(65950P, 65552P, 65940P, "Button", "Start", 65940P, 65950P, 65940P), #(131608P, 65552P, 131556P, "tooltips_class32", "", 131556P, 131608P, 131556P), #(131558P, 65552P, 131556P, "_SearchEditBoxFakeWindow", "", 131556P, 131558P, 131556P), #(131572P, 65552P, 131556P, "tooltips_class32", "", 131556P, 131572P, 131556P), #(197126P, 65552P, 131556P, "tooltips_class32", "", 131556P, 197126P, 131556P), #(131632P, 65552P, 131556P, "Desktop User Picture", "Rene Baca", 131556P, 131632P, 131556P), #(65940P, 65552P, 0P, "Shell_TrayWnd", "", 0P, 65940P, 65940P), #(131556P, 65552P, 0P, "DV2ControlHost", "Start menu", 0P, 131556P, 131556P), #(66018P, 65552P, 65940P, "CiceroUIWndFrame", "CiceroUIWndFrame", 65940P, 66018P, 65940P), ...)
Child:#(#(1378864P, 2432120P, 2432120P, "#32770", "Graphite Modeling Tools (Vertical)", 2432120P, 2432120P, 2432120P), #(920154P, 2432120P, 2432120P, "#32770", "Graphite Modeling Tools", 2432120P, 2432120P, 2432120P), #(724404P, 920154P, 920154P, "HwndWrapper[3dsmax.exe;;3b051322-b810-4285-9047-09e87a76d5ed]", "Graphite Modeling Tools", 0P, 2432120P, 2432120P), #(854362P, 2432120P, 2432120P, "#32770", "Main Toolbar", 2432120P, 2432120P, 2432120P), #(919462P, 854362P, 854362P, "CustToolbar", "", 0P, 2432120P, 2432120P), #(658538P, 919462P, 919462P, "CustSeparator", "", 0P, 2432120P, 2432120P), #(919874P, 919462P, 919462P, "CustButton", "", 0P, 2432120P, 2432120P), #(592102P, 919462P, 919462P, "CustButton", "", 0P, 2432120P, 2432120P), #(592746P, 919462P, 919462P, "CustButton", "", 0P, 2432120P, 2432120P), #(592270P, 919462P, 919462P, "CustSeparator", "", 0P, 2432120P, 2432120P), #(658054P, 919462P, 919462P, "ComboBox", "All", 0P, 2432120P, 2432120P), #(658070P, 919462P, 919462P, "CustButton", "", 0P, 2432120P, 2432120P), #(592390P, 919462P, 919462P, "CustButton", "", 0P, 2432120P, 2432120P), #(592426P, 919462P, 919462P, "CustButton", "", 0P, 2432120P, 2432120P), #(592424P, 919462P, 919462P, "CustButton", "", 0P, 2432120P, 2432120P), #(658914P, 919462P, 919462P, "CustSeparator", "", 0P, 2432120P, 2432120P), #(657966P, 919462P, 919462P, "CustButton", "", 0P, 2432120P, 2432120P), #(990928P, 919462P, 919462P, "CustButton", "", 0P, 2432120P, 2432120P), #(986184P, 919462P, 919462P, "CustButton", "", 0P, 2432120P, 2432120P), #(657934P, 919462P, 919462P, "ComboBox", "View", 0P, 2432120P, 2432120P), ...)
Child:#(#(1378864P, 2432120P, 2432120P, "#32770", "Graphite Modeling Tools (Vertical)", 2432120P, 2432120P, 2432120P), #(920154P, 2432120P, 2432120P, "#32770", "Graphite Modeling Tools", 2432120P, 2432120P, 2432120P), #(724404P, 920154P, 920154P, "HwndWrapper[3dsmax.exe;;3b051322-b810-4285-9047-09e87a76d5ed]", "Graphite Modeling Tools", 0P, 2432120P, 2432120P), #(854362P, 2432120P, 2432120P, "#32770", "Main Toolbar", 2432120P, 2432120P, 2432120P), #(919462P, 854362P, 854362P, "CustToolbar", "", 0P, 2432120P, 2432120P), #(658538P, 919462P, 919462P, "CustSeparator", "", 0P, 2432120P, 2432120P), #(919874P, 919462P, 919462P, "CustButton", "", 0P, 2432120P, 2432120P), #(592102P, 919462P, 919462P, "CustButton", "", 0P, 2432120P, 2432120P), #(592746P, 919462P, 919462P, "CustButton", "", 0P, 2432120P, 2432120P), #(592270P, 919462P, 919462P, "CustSeparator", "", 0P, 2432120P, 2432120P), #(658054P, 919462P, 919462P, "ComboBox", "All", 0P, 2432120P, 2432120P), #(658070P, 919462P, 919462P, "CustButton", "", 0P, 2432120P, 2432120P), #(592390P, 919462P, 919462P, "CustButton", "", 0P, 2432120P, 2432120P), #(592426P, 919462P, 919462P, "CustButton", "", 0P, 2432120P, 2432120P), #(592424P, 919462P, 919462P, "CustButton", "", 0P, 2432120P, 2432120P), #(658914P, 919462P, 919462P, "CustSeparator", "", 0P, 2432120P, 2432120P), #(657966P, 919462P, 919462P, "CustButton", "", 0P, 2432120P, 2432120P), #(990928P, 919462P, 919462P, "CustButton", "", 0P, 2432120P, 2432120P), #(986184P, 919462P, 919462P, "CustButton", "", 0P, 2432120P, 2432120P), #(657934P, 919462P, 919462P, "ComboBox", "View", 0P, 2432120P, 2432120P), ...)
Item:#(13371606P, 2166150P, 2166150P, "CustToolbar", "", 0P, 2432120P, 2432120P)
Child:#(#(789120P, 13371606P, 13371606P, "CustButton", "", 0P, 2432120P, 2432120P), #(657786P, 13371606P, 13371606P, "CustSeparator", "", 0P, 2432120P, 2432120P), #(659034P, 13371606P, 13371606P, "CustButton", "", 0P, 2432120P, 2432120P), #(592314P, 13371606P, 13371606P, "CustSeparator", "", 0P, 2432120P, 2432120P), #(790670P, 13371606P, 13371606P, "CustButton", "", 0P, 2432120P, 2432120P), #(1378322P, 13371606P, 13371606P, "CustButton", "", 0P, 2432120P, 2432120P), #(592308P, 13371606P, 13371606P, "CustSeparator", "", 0P, 2432120P, 2432120P), #(2956446P, 13371606P, 13371606P, "CustButton", "", 0P, 2432120P, 2432120P))
Child:#(#(657904P, 2166150P, 2166150P, "ListBox", "", 0P, 2432120P, 2432120P), #(657658P, 2166150P, 2166150P, "CustButton", "Sets", 0P, 2432120P, 2432120P), #(657614P, 2166150P, 2166150P, "CustButton", "", 0P, 2432120P, 2432120P), #(657600P, 2166150P, 2166150P, "CustButton", "Skin", 0P, 2432120P, 2432120P), #(723294P, 2166150P, 2166150P, "CustButton", "Skin Wrap", 0P, 2432120P, 2432120P), #(657464P, 2166150P, 2166150P, "CustButton", "STL Check", 0P, 2432120P, 2432120P), #(657996P, 2166150P, 2166150P, "CustButton", "Edit Poly", 0P, 2432120P, 2432120P), #(722940P, 2166150P, 2166150P, "CustButton", "Morph UV Data", 0P, 2432120P, 2432120P), #(657576P, 2166150P, 2166150P, "CustButton", "", 0P, 2432120P, 2432120P), #(657394P, 2166150P, 2166150P, "CustButton", "User1", 0P, 2432120P, 2432120P), #(657478P, 2166150P, 2166150P, "CustButton", "User1", 0P, 2432120P, 2432120P), #(724698P, 2166150P, 2166150P, "CustButton", "User1", 0P, 2432120P, 2432120P), #(723304P, 2166150P, 2166150P, "CustButton", "User1", 0P, 2432120P, 2432120P), #(658002P, 2166150P, 2166150P, "CustButton", "User1", 0P, 2432120P, 2432120P), #(1903654P, 2166150P, 2166150P, "CustButton", "User1", 0P, 2432120P, 2432120P), #(920552P, 2166150P, 2166150P, "CustButton", "User1", 0P, 2432120P, 2432120P), #(658042P, 2166150P, 2166150P, "CustButton", "User1", 0P, 2432120P, 2432120P), #(723562P, 2166150P, 2166150P, "CustButton", "User1", 0P, 2432120P, 2432120P), #(1051914P, 2166150P, 2166150P, "CustButton", "User1", 0P, 2432120P, 2432120P), #(592278P, 2166150P, 2166150P, "CustButton", "User1", 0P, 2432120P, 2432120P), ...)
Child:#(#(657904P, 2166150P, 2166150P, "ListBox", "", 0P, 2432120P, 2432120P), #(657658P, 2166150P, 2166150P, "CustButton", "Sets", 0P, 2432120P, 2432120P), #(657614P, 2166150P, 2166150P, "CustButton", "", 0P, 2432120P, 2432120P), #(657600P, 2166150P, 2166150P, "CustButton", "Skin", 0P, 2432120P, 2432120P), #(723294P, 2166150P, 2166150P, "CustButton", "Skin Wrap", 0P, 2432120P, 2432120P), #(657464P, 2166150P, 2166150P, "CustButton", "STL Check", 0P, 2432120P, 2432120P), #(657996P, 2166150P, 2166150P, "CustButton", "Edit Poly", 0P, 2432120P, 2432120P), #(722940P, 2166150P, 2166150P, "CustButton", "Morph UV Data", 0P, 2432120P, 2432120P), #(657576P, 2166150P, 2166150P, "CustButton", "", 0P, 2432120P, 2432120P), #(657394P, 2166150P, 2166150P, "CustButton", "User1", 0P, 2432120P, 2432120P), #(657478P, 2166150P, 2166150P, "CustButton", "User1", 0P, 2432120P, 2432120P), #(724698P, 2166150P, 2166150P, "CustButton", "User1", 0P, 2432120P, 2432120P), #(723304P, 2166150P, 2166150P, "CustButton", "User1", 0P, 2432120P, 2432120P), #(658002P, 2166150P, 2166150P, "CustButton", "User1", 0P, 2432120P, 2432120P), #(1903654P, 2166150P, 2166150P, "CustButton", "User1", 0P, 2432120P, 2432120P), #(920552P, 2166150P, 2166150P, "CustButton", "User1", 0P, 2432120P, 2432120P), #(658042P, 2166150P, 2166150P, "CustButton", "User1", 0P, 2432120P, 2432120P), #(723562P, 2166150P, 2166150P, "CustButton", "User1", 0P, 2432120P, 2432120P), #(1051914P, 2166150P, 2166150P, "CustButton", "User1", 0P, 2432120P, 2432120P), #(592278P, 2166150P, 2166150P, "CustButton", "User1", 0P, 2432120P, 2432120P), ...)
Name:CustToolbar


 --
 
 
 fn doesCommandPanelFloat = (windows.getchildhwnd 0 "Command Panel" != undefined)
 fn dockCommandPanel state:on = if doesCommandPanelFloat() == state do
 (
 	local ini = cui.getConfigFile()
 	local pos = getIniSetting ini "Command Panel" "CurPos"
 
 	pos = (if state then "8" else "16") + (trimleft pos "0123456789")
 	setIniSetting ini "Command Panel" "CurPos" pos
 	cui.loadConfig ini
 
 	state
 )
 
 --i try to avoid using of cui.saveConfig() because usually it takes time.
 
 
cp_pos = getIniSetting ini "Command Panel" "CurPos"
 
 max_ini = getMaxIniFile()
mod_stack_buttons_visible = getIniSetting max_ini "Modstack"  "visible"